<!DOCTYPE html>
<html>
<head>
    <title>Testing require(script)</title>
    <link rel='stylesheet' type='text/css' href='../styles/tests.css'/>
    <link rel='icon' type='image/png' href='../images/gear2.png'>
    <script src='../lib/jquery.js'></script>
    <script src='../lib/underscore.js'></script>
    <script src='../require-scripts.js'></script>

</head>
<body>
<a href='../'>back</a>

<h2>test custom require</h2>

<p id='verify'>
    <button class='test'>all</button>
    <br/>
</p>
<div>
    <pre class='console'>

    </pre>
</div>

<script>
    var consoleLogBack = console.log;
    var $console;
    var consoleLogNew = function consoleLogNew() {
        consoleLogBack.apply(console, arguments);
        if (!$console) return;
        for (var i = 0; i < arguments.length; i++) {
            $console.append(arguments[i] + ' ');
        }
        $console.append('\n');
    };
    window.onload = function () {
        var verify = {
            'three.js': ['BoxGeometry', 'Vector3', 'Mesh'],
            'ammo.js': ['btVector3'],
            'underscore.js': ['each', 'map', 'pick', 'pluck'],
            'jquery.js': ['ajax', 'css', 'attr', 'text', 'parseJSON', 'parseXML'],
            'test-utils.js': ['run', 'all'],
            'factory.js': ['addLibrary', 'extendFromDescription','description','Shape']

        };
        var $verify = $('#verify');
        for (var i in verify) {
          $verify.append("<button class='test'>" + i + "</button>");
        }
        var utils = require('test-utils.js', undefined);

        $('.test').click(function (event) {
            $console = $('.console');
            $console.empty();
            var library = $(event.target).text();
            if (library == 'all') {
                for(var i in verify){
                    runRequireTest(i);
                }
            } else {
                runRequireTest(library);
            }
            function runRequireTest(library) {
                setTimeout(function () {
                    console.log = consoleLogNew;
                    console.log('\n-------------', library, '---------------\n');

                    var obj = require(library, undefined);

                    utils.checkKeys(obj, verify[library], 'check keys in ' + library);

                    console.log = consoleLogBack;
                }, 100);
            }
        });
    };


</script>
</body>
</html>