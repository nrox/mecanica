<!DOCTYPE html>
<html>
<head>
    <title class='title'>Tests</title>
    <link rel='stylesheet' type='text/css' href='../styles/tests.css'/>
    <link rel='icon' type='image/png' href='../images/gear2.png'>
    <script src='../lib/jquery.js'></script>
    <script src='../lib/underscore.js'></script>
    <script src='../require-scripts.js'></script>

</head>
<body>
<a href='../'>../</a>

<h2 class='index'>Tests index</h2>

<div><p id='index'></p></div>
<h3 class='title'>&nbsp;</h3>

<p id='verify'></p>

<div id='container'></div>
<div class='console'></div>

<script>
    var library = {};
    var scripts = {
        'require': 'test-require.js',
        'ammo': 'test-ammo.js',
        'factory': 'test-factory.js',
        'collision': 'test-collision.js',
        'rendering': 'test-render.js',
        'shapes': 'test-shapes.js'
    };

    function loadTest(event) {
        library && library.clearObjects && library.clearObjects();
        $('#container').empty();
        setConsole('.console');
        var title = $(event.target).text();
        $('.title').text('Test: ' + title);
        var script = $(event.target).attr('script');
        library = require(script, undefined);
        var $verify = $('#verify');
        $verify.empty();
        _.each(library.test, function (fun, name) {
            $verify.append("<button class='test'>" + name + "</button>");
        });
        $verify.children('.test').on('click', runTest);
    }

    function runTest(event) {
        library && library.clearObjects && library.clearObjects();
        setConsole('.console');
        var title = $(event.target).text();
        console.info(title);
        library.test[title]();
    }

    window.onload = function () {
        var utils = require('test-utils.js', undefined);
        var $index = $('#index');
        _.each(scripts, function (script, title) {
            $index.append("<button class='test' script='" + script + "'>" + title + "</button>");
        });
        setConsole('.console');
        console.info('ready');
        $index.children('.test').on('click', loadTest);
    };


</script>
</body>
</html>